{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "width": "container",
    "height": 600,
    "params": [
      {"name": "PlantedBefore", "value":2021, "bind": {"input": "range", "min": 1889, "max": 2021, "step": 1}},
      {"name": "zoom_level", "value": 350000, "bind": {"input": "range", "min": 350000, "max": 3000000, "step": 5000}},
      {"name": "centerX", "value": 0, "bind": {"input": "range", "min": -1000, "max": 1000, "step": 100}},
      {"name": "centerY", "value": 0, "bind": {"input": "range", "min": -1000, "max": 1000, "step": 100}}
    ],
    "title": "Trees in the City of Melbourne",
    "projection": {"type": "conicEqualArea",  "parallels":[144.9515185,-37.80149821], "center": {"expr": "[144.9515185+centerX/10000,-37.80149821+centerY/10000]"}, "scale":{"expr": "zoom_level"}},
    "padding": 15,
    "layer": [
      {
        "data": {
          "url": "data/features.topojson",
          "format": {"type": "topojson", "feature": "features"}
        },
        "mark": {"type": "geoshape", "fill": "#E0ECF4", "stroke": "darkgray"}
      },
      {
        "data": {"url": "data/Trees__with_species_and_dimensions__Urban_Forest_.csv",        "format":{"type": "csv", "parse": {"YearPlanted": "number"}}},
        "transform": [{"filter": "datum.YearPlanted <= PlantedBefore"}],
        "mark": "circle",
        "encoding": {
          "longitude": {"field": "Longitude", "type": "quantitative"},
          "latitude": {"field": "Latitude", "type": "quantitative"},
          "tooltip": [
            {"field": "CoM ID", "type": "ordinal", "title": "Tree ID: "},
            {"field": "Located in", "type": "nominal", "title": "Located in: "},
            {"field": "height", "type": "quantitative", "title": "Height: "}
          ],
          "size": {"value": 5},
          "color": {
            "field": "AgeDescription",
            "scale": {
              "range": ["#A5DB96","#87CC79","#6AB25F","#4E9A51","#346636","#808080"]
            },
            "type": "ordinal",
            "sort": [
              "New",
              "Juvenile",
              "Semi-Mature",
              "Mature",
              "Over-mature",
              "Unknown"
            ],
            "title": "Age of the tree"
          }
        }
      }
    ],
    "config": {"background": "#E0ECF4",  "style": {
      "cell": {
        "stroke": "transparent"
      }
    }}
  }